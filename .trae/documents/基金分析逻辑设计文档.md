## 基金分析逻辑设计文档

### 一、整体架构
基于现有项目结构，整合akshare数据源，设计三大核心模块：
1. **基金分组管理** - 投资组合概念
2. **基金基础数据维护** - 自动同步+指标计算
3. **持仓管理** - 交易记录+盈亏计算

### 二、数据库表结构设计

#### 2.1 保留现有表（已有）
- `fund_info` - 基金基本信息
- `fund_nav` - 基金净值历史
- `fund_stock_holding` - 基金持仓
- `fund_dividend` - 基金分红
- `fund_company` - 基金公司
- `fund_manager` - 基金经理
- `fund_scale` - 基金规模
- `fund_rating` - 基金评级

#### 2.2 新增/完善表
- `fund_groups` - 基金分组（已有）
- `fund_group_members` - 分组基金关联（已有）
- `fund_positions` - 持仓记录（已有）
- `fund_transactions` - 交易流水（已有）
- `fund_metrics` - 基金指标（最大回撤、夏普比率等）

### 三、功能模块设计

#### 3.1 基金分组管理
- 创建/编辑/删除分组
- 基金加入/移除分组
- 分组维度统计分析

#### 3.2 基金基础数据同步
使用akshare接口：
- `fund_name_em()` - 基金基本信息
- `fund_open_fund_daily_em()` - 每日净值
- `fund_open_fund_info_em()` - 历史净值
- `fund_portfolio_hold_em()` - 持仓数据
- `fund_individual_analysis_xq()` - 夏普比率、最大回撤等
- `fund_overview_em()` - 基金概况（规模、费率等）
- `fund_fee_em()` - 交易费率

#### 3.3 持仓管理
- 首次录入：输入当前盈利，反算持仓净值
- 交易记录：买入/卖出
- 自动计算：最新盈亏、收益率、持有天数

### 四、API设计

#### 4.1 分组管理API（已有）
- `GET/POST /api/portfolio/groups`
- `GET/PUT/DELETE /api/portfolio/groups/{id}`
- `GET/POST /api/portfolio/groups/{id}/funds`

#### 4.2 持仓管理API（已有）
- `GET /api/portfolio/positions`
- `GET /api/portfolio/positions/{id}`
- `POST /api/portfolio/transactions`
- `GET /api/portfolio/summary`

#### 4.3 基金数据API（已有）
- `GET /api/funds`
- `GET /api/funds/{code}`
- `GET /api/funds/{code}/nav`
- `GET /api/funds/{code}/holdings`

#### 4.4 同步API（已有）
- `POST /api/sync/fund-basic`
- `POST /api/sync/fund-nav`
- `POST /api/sync/fund-portfolio`

### 五、删除/简化功能
1. 删除tushare相关同步器（保留akshare）
2. 简化数据源配置（默认使用akshare）
3. 删除WebSocket实时推送（简化架构）

### 六、前端页面设计
1. **分组管理页** - 分组CRUD+基金列表
2. **基金详情页** - 净值走势+持仓+指标
3. **持仓管理页** - 持仓列表+交易记录+盈亏统计
4. **数据同步页** - 同步控制+进度展示

请确认这个设计方案后，我将编写完整的设计文档。